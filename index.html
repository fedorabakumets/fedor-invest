<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∞–π—Ç–æ–≤ –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞: –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∏ —Ç–∏–ø—ã —Ä–∞–±–æ—Ç—ã. –£–¥–æ–±–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ 2025 –≥–æ–¥–∞.">
    <meta name="keywords" content="—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∞–π—Ç–æ–≤, —Å–∞–π—Ç—ã –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞">
    <meta name="robots" content="index, follow">
    <meta name="author" content="–í–∞—à_–ò–º—è">
    <title>–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∫–ª–∏–∫–∞—Ö</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Roboto+Condensed:wght@400;700&family=Arial&display=swap" rel="stylesheet" media="print, screen">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS Styling */
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f5f5, #e0e0e0, #d0d0d0, #b0c4de, #add8e6);
            color: #333;
            padding: 10px;
            font-size: 16px;
            line-height: 1.5;
            animation: backgroundShift 15s infinite alternate;
            margin: 0;
        }

        @keyframes backgroundShift {
            0% { background: linear-gradient(135deg, #f5f5f5, #e0e0e0, #d0d0d0, #b0c4de, #add8e6); }
            50% { background: linear-gradient(135deg, #add8e6, #b0c4de, #d0d0d0, #e0e0e0, #f5f5f5); }
            100% { background: linear-gradient(135deg, #f5f5f5, #e6e6fa, #d8bfd8, #e0e0e0, #add8e6); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 10px;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        h1, h3 {
            font-family: 'Roboto Condensed', sans-serif;
        }

        h1 {
            font-size: 2rem;
            font-weight: 600;
            letter-spacing: 1px;
            background: linear-gradient(90deg, #0066cc, #3333ff, #00ff99);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3), 0 0 15px rgba(0, 102, 204, 0.5);
            animation: glow 2s infinite alternate;
        }

        @keyframes glow {
            0% { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3), 0 0 15px rgba(0, 102, 204, 0.5); }
            100% { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5), 0 0 25px rgba(0, 255, 204, 0.7); }
        }

        .intro p {
            font-size: 1rem;
            line-height: 1.5;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            background: linear-gradient(90deg, #cce5ff, #ccffff);
            padding: 8px;
            border-radius: 6px;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-bottom: 2px;
            background: linear-gradient(135deg, #ffffff, #f0f4f8, #e6e6fa, #d8bfd8);
            padding: 4px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15), 0 0 30px rgba(0, 102, 204, 0.2);
        }

        .filter-section {
            width: 48%;
            position: relative;
        }

        .filter-toggle {
            font-size: 1.1rem;
            margin-bottom: 6px;
            color: #0066cc;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            padding: 5px;
            transition: background 0.3s ease;
        }

        .filter-toggle:hover {
            background: rgba(0, 102, 204, 0.1);
        }

        .filter-toggle::before {
            font-family: "Font Awesome 5 Free";
            margin-right: 5px;
            font-weight: 900;
            color: #00ff99;
            animation: bounce 1.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        #paymentFilters .filter-toggle::before {
            content: "\f555";
        }

        #workFilters .filter-toggle::before {
            content: "\f0ad";
        }

        .filter-toggle::after {
            content: "";
            position: absolute;
            width: 70%;
            height: 2px;
            background: linear-gradient(90deg, #0066cc, #00ff99);
            bottom: -4px;
            left: 0;
            animation: widthPulse 2s infinite;
        }

        @keyframes widthPulse {
            0% { width: 70%; }
            50% { width: 100%; }
            100% { width: 70%; }
        }

        [data-theme="dark"] .filter-toggle::after {
            animation: none;
        }

        .toggle-icon {
            transition: transform 0.3s ease;
        }

        .filter-section.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .filter-content {
            max-height: 500px;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .filter-section.collapsed .filter-content {
            max-height: 0;
            opacity: 0;
        }

        .filter-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .filter-section label {
            font-size: 0.9rem;
            color: #444;
            transition: all 0.3s ease;
            flex: 1 1 calc(33% - 5px);
            cursor: pointer;
            padding: 2px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .filter-section input[type="checkbox"] {
            appearance: none;
            width: 16px;
            height: 16px;
            border: 2px solid #0066cc;
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-section input[type="checkbox"]:checked {
            background: linear-gradient(90deg, #0066cc, #00ff99);
            transform: rotate(360deg);
        }

        .filter-section input[type="checkbox"]:checked::after {
            content: "\f00c";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 10px;
        }

        .filter-section input[type="checkbox"]:hover {
            box-shadow: 0 0 8px rgba(0, 102, 204, 0.5);
        }

        .filter-section label:hover {
            color: #0066cc;
            transform: translateX(3px);
        }

        .filters-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 2px 0;
        }

        button#resetFilters {
            padding: 8px 15px;
            background: linear-gradient(90deg, #4169e1, #4682b4, #ffcc00);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 102, 204, 0.5);
            position: relative;
            overflow: hidden;
        }

        button#resetFilters::before {
            font-family: "Font Awesome 5 Free";
            content: "\f00d";
            margin-right: 5px;
            font-weight: 900;
        }

        button#resetFilters::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.5s ease;
        }

        button#resetFilters:hover::after {
            left: 100%;
        }

        button#resetFilters:hover {
            animation: shake 0.5s infinite;
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.8);
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
            75% { transform: translateX(-3px); }
            100% { transform: translateX(0); }
        }

        select#themeSwitch {
            padding: 6px;
            border-radius: 6px;
            background: rgba(255, 255, 215, 0.8);
            border: 2px solid #0066cc;
        }

        .error-message {
            background: linear-gradient(90deg, #4169e1, #4682b4);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 2px;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(0, 102, 204, 0.5);
            animation: slideIn 0.5s ease;
            display: none;
        }

        .error-message.show {
            display: flex;
        }

        .error-message.hide {
            animation: slideOut 0.5s ease forwards;
        }

        @keyframes slideIn {
            0% { transform: translateX(-100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            0% { transform: translateX(0); opacity: 1; }
            100% { transform: translateX(-100%); opacity: 0; }
        }

        .error-message::before {
            font-family: "Font Awesome 5 Free";
            content: "\f071";
            font-weight: 900;
            font-size: 16px;
            animation: spin 2s infinite linear;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .table-section {
            margin-top: 2px;
        }

        table {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            border-collapse: collapse;
            background: linear-gradient(135deg, #f9f9f9, #e6e6fa);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25), 0 0 60px rgba(0, 255, 204, 0.4);
            margin: 15px 0;
            border: 3px solid #0066cc;
            animation: tableGlow 3s infinite alternate;
        }

        @keyframes tableGlow {
            0% { box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25), 0 0 60px rgba(0, 255, 204, 0.4); }
            100% { box-shadow: 0 8px 25px rgba(0, 0, 0, 0.35), 0 0 80px rgba(0, 102, 204, 0.6); }
        }

        th, td {
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            text-align: left;
        }

        th {
            background: linear-gradient(90deg, #3333ff, #00ff99);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid #0066cc;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        th:hover {
            background: linear-gradient(90deg, #0066cc, #00ff99);
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.7);
            transform: scale(1.05);
        }

        td {
            background: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
            color: #2c2c2c;
        }

        table tbody tr {
            transition: all 0.3s ease;
        }

        table tbody tr.hidden {
            opacity: 0;
            height: 0;
            padding: 0;
            margin: 0;
            overflow: hidden;
        }

        table tbody tr:nth-child(odd) {
            background: rgba(240, 248, 255, 0.8);
        }

        table tbody tr:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
        }

        table tbody tr:hover td {
            background: rgba(255, 245, 238, 0.9);
        }

        .site-link-with-icon {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .site-icon {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        td a {
            color: #0066cc;
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }

        td a::after {
            content: "\f35d";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            margin-left: 8px;
            font-size: 14px;
            color: #00ff99;
        }

        td a:hover {
            color: #00ff99;
            text-shadow: 0 0 10px rgba(0, 255, 204, 0.7);
        }

        td a:hover::after {
            animation: bounce 1s infinite;
        }

        .sort-icon {
            font-size: 14px;
            margin-left: 8px;
            color: #ffcc00;
        }

        .sort-icon.active {
            color: #00ff99;
            animation: spin 1s infinite linear;
        }

        #pagination {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        #pagination button {
            padding: 6px 12px;
            background: linear-gradient(90deg, #0066cc, #00ff99);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #pagination button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.7);
        }

        #pagination button:disabled {
            background: linear-gradient(90deg, #ccc, #aaa);
            cursor: not-allowed;
        }

        #pagination select {
            padding: 6px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #0066cc;
        }

        [data-theme="dark"] {
            background: linear-gradient(135deg, #0a0a0a, #1e1e2f, #2a2a3d);
            color: #e0e0e0;
        }

        [data-theme="dark"] .container {
            background: rgba(30, 30, 30, 0.7);
        }

        [data-theme="dark"] .intro p {
            background: rgba(30, 30, 30, 0.9);
            color: #e0e0e0;
        }

        [data-theme="dark"] .filters {
            background: rgba(30, 30, 30, 0.7);
            box-shadow: 0 4px 10px rgba(0, 255, 153, 0.2);
        }

        [data-theme="dark"] .filter-toggle {
            color: #00ff99;
        }

        [data-theme="dark"] .filter-section label {
            color: #e0e0e0;
            background: rgba(40, 40, 50, 0.9);
        }

        [data-theme="dark"] table {
            background: linear-gradient(135deg, #1e1e2f, #2a2a3d);
            border: 3px solid #00ff99;
        }

        [data-theme="dark"] th {
            background: linear-gradient(90deg, #00ff99, #0066cc);
            border-bottom: 3px solid #00ff99;
        }

        [data-theme="dark"] th:hover {
            background: linear-gradient(90deg, #0066cc, #00ff99);
            box-shadow: 0 0 15px rgba(0, 255, 153, 0.5);
        }

        [data-theme="dark"] td {
            background: rgba(40, 40, 50, 0.9);
            color: #e0e0e0;
            border: 2px solid #00ff99;
        }

        [data-theme="dark"] table tbody tr:nth-child(odd) {
            background: rgba(50, 50, 60, 0.85);
        }

        [data-theme="dark"] table tbody tr:hover td {
            background: rgba(60, 60, 70, 0.9);
        }

        [data-theme="dark"] .error-message {
            background: linear-gradient(90deg, #4682b4, #4169e1);
        }

        [data-theme="dark"] button#resetFilters {
            background: linear-gradient(90deg, #00ff99, #0066cc);
        }

        [data-theme="dark"] .last-changes-content {
            background: linear-gradient(135deg, #1e1e2f, #2a2a3d);
            border-left: 4px solid #00ff99;
        }

        [data-theme="dark"] #changesList li {
            color: #e0e0e0;
        }

        [data-theme="dark"] .all-changes-btn {
            background: linear-gradient(90deg, #00ff99, #0066cc);
        }

        [data-theme="dark"] #pagination {
            background: rgba(30, 30, 30, 0.7);
        }

        [data-theme="dark"] #pagination button {
            background: linear-gradient(90deg, #00ff99, #0066cc);
        }

        [data-theme="dark"] h1 {
            background: linear-gradient(90deg, #00ff99, #00ffcc, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: none;
            filter: drop-shadow(0 0 10px rgba(0, 255, 153, 0.6));
        }

        [data-theme="dark"] h1, h3 {
            font-family: 'Roboto Condensed', sans-serif;
        }

        .last-changes-container {
            margin: 10px auto;
            max-width: 600px;
        }

        #toggleLastChanges {
            width: 100%;
            padding: 8px 15px;
            background: linear-gradient(90deg, #0066cc, #00ff99);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        #toggleLastChanges:hover {
            transform: scale(1.02);
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.7);
        }

        .last-changes-content {
            background: linear-gradient(135deg, #f0f8ff, #e6f0fa);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
            border-left: 4px solid #27ae60;
            margin-top: 5px;
            max-height: none;
            overflow-y: visible;
            transition: max-height 0.3s ease, opacity 0.3s ease;
        }

        .last-changes-content.hidden {
            display: none;
        }

        #changesList {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        #changesList li {
            font-size: 0.9em;
            color: #333;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            line-height: 1.4;
        }
        #changesList li:last-child {
            border-bottom: none;
        }
        #changesList li a {
            color: #d32f2f;
            text-decoration: none;
            font-weight: 500;
        }
        #changesList li a:hover {
            text-decoration: underline;
        }
        #changesList .site-name {
            font-weight: bold;
            color: #2c3e50;
        }
        #changesList .site-name a {
            color: #0066cc;
        }
        #changesList .old-value {
            color: #5a6268;
            font-style: italic;
        }
        #changesList .new-value {
            color: #27ae60;
            font-weight: bold;
        }
        [data-theme="dark"] #changesList .site-name {
            color: #e0e0e0;
        }
        [data-theme="dark"] #changesList .site-name a {
            color: #00ff99;
        }
        [data-theme="dark"] #changesList .old-value {
            color: #b0b0b0;
        }
        [data-theme="dark"] #changesList .new-value {
            color: #4caf50;
        }

        .all-changes-btn {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            background: linear-gradient(90deg, #0066cc, #00ff99);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .all-changes-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.7);
        }

        @media (max-width: 768px) {
            .filters {
                flex-direction: column;
                gap: 3px;
                padding: 3px;
            }
            .filter-section {
                width: 100%;
            }
            .filter-toggle {
                font-size: 1rem;
                margin-bottom: 3px;
            }
            .filter-section label {
                font-size: 0.85rem;
                flex: 1 1 calc(50% - 3px);
            }
            .table-section {
                margin-top: 1px;
            }
            table {
                min-width: 1000px;
            }
        }

        @media (max-width: 480px) {
            body {
                font-size: 14px;
                padding: 5px;
            }
            h1 {
                font-size: 1.5rem;
            }
            .intro p {
                font-size: 0.9rem;
                padding: 6px;
                margin-bottom: 8px;
            }
            .filters {
                padding: 2px;
            }
            .filter-toggle {
                font-size: 0.9rem;
            }
            .filter-section label {
                font-size: 0.8rem;
                flex: 1 1 calc(100% - 3px);
            }
            table {
                font-size: 13px;
            }
            th, td {
                padding: 8px 10px;
            }
        }

        /* Cards View Styles */
        .view-toggle-btn {
            padding: 8px 15px;
            background: linear-gradient(90deg, #4169e1, #4682b4, #ffcc00);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 102, 204, 0.5);
        }

        .view-toggle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 102, 204, 0.7);
        }

        .cards-view table {
            margin: 0 !important;
            min-width: auto;
            width: 100%;
            box-shadow: none;
            border: none;
            background: transparent;
        }

        .cards-view table thead {
            display: none;
        }

        .cards-view table tbody {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }

        .card-column {
            flex: 1;
            min-width: 300px;
        }

        .cards-view table tbody tr {
            display: grid;
            grid-template-columns: 1fr;
            margin-bottom: 20px;
            border: 2px solid #0066cc;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.12);
            padding: 16px;
            transition: all 0.3s ease;
            width: 100%;
            box-sizing: border-box;
            gap: 12px;
        }

        .cards-view table tbody tr:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 102, 204, 0.2);
            border-color: #3366dd;
        }

        .cards-view table tbody td {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 10px;
            align-items: flex-start;
            padding: 0;
            border: none;
            background: transparent;
            width: 100%;
            box-sizing: border-box;
        }

        .cards-view table tbody td:first-child {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 8px;
            border-bottom: 2px solid #e8e8e8;
            gap: 15px;
        }

        .cards-view table tbody td:nth-child(2) {
            grid-column: 1 / -1;
            padding-top: 6px;
        }

        .cards-view table tbody td:last-child {
            border-bottom: none;
        }

        .cards-view table tbody td::before {
            content: attr(data-label);
            font-weight: 600;
            color: #0066cc;
            text-align: left;
            font-size: 0.95em;
            display: block;
            margin-bottom: 4px;
            grid-column: 1 / -1;
        }

        .cards-view table tbody td a,
        .cards-view table tbody td span {
            word-break: break-word;
            text-align: left;
            color: #333;
            font-size: 0.95em;
            line-height: 1.4;
        }

        .cards-view table tbody td:first-child a {
            font-weight: 600;
            font-size: 1.05em;
            color: #0066cc;
            grid-column: 1;
            border-bottom: none;
            padding-bottom: 0;
        }


        [data-theme="dark"] .cards-view table tbody tr {
            background: rgba(60, 60, 60, 0.95);
            border-color: #00ff99;
        }

        [data-theme="dark"] .cards-view table tbody td {
            border-bottom-color: #444;
        }

        [data-theme="dark"] .cards-view table tbody td::before {
            color: #00ff99;
        }

        @media (max-width: 768px) {
            .card-column {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="intro">
            <h1>–ó–∞—Ä–∞–±–æ—Ç–æ–∫ –Ω–∞ –∫–ª–∏–∫–∞—Ö</h1>
            <p>–ò—â–µ—Ç–µ –ª—É—á—à–∏–µ —Å–∞–π—Ç—ã –¥–ª—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞ –æ–Ω–ª–∞–π–Ω? –ù–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã –Ω–∞–π–¥–µ—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∞–π—Ç–æ–≤ –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º–µ –≤—ã–≤–æ–¥–∞, —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º –∏ –º–Ω–æ–≥–∏–º –¥—Ä—É–≥–∏–º –¥–∞–Ω–Ω—ã–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç, –∏ —Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —Å–≤–æ–∏–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º. –û–±–Ω–æ–≤–ª–µ–Ω–æ –≤ –∞–ø—Ä–µ–ª–µ 2025 –≥–æ–¥–∞.</p>
            <p id="lastUpdated">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="updateTimestamp">...</span></p>
            <div id="lastChangesBlock" class="last-changes-container">
                <button id="toggleLastChanges" aria-label="–°–∫—Ä—ã—Ç—å/–ø–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è">
                    <i class="fas fa-eye"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
                <div id="lastChangesContent" class="last-changes-content hidden">
                    <ul id="changesList"></ul>
                    <a href="/all-changes.html" id="allChangesLink" class="all-changes-btn" aria-label="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è">
                        <i class="fas fa-history"></i> –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    </a>
                </div>
            </div>
            <button id="fontSizeIncrease" aria-label="–£–≤–µ–ª–∏—á–∏—Ç—å —à—Ä–∏—Ñ—Ç">+</button>
            <button id="fontSizeDecrease" aria-label="–£–º–µ–Ω—å—à–∏—Ç—å —à—Ä–∏—Ñ—Ç">-</button>
        </div>

        <section class="filters">
            <div class="filter-section" id="paymentFilters" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º">
                <h3 class="filter-toggle" aria-controls="paymentContainer" aria-expanded="true">
                    –§–∏–ª—å—Ç—Ä –ø–æ –ø–ª–∞—Ç–µ–∂–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º (<span class="filter-count">0</span>)
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </h3>
                <div class="filter-content">
                    <div class="filter-container" id="paymentContainer"></div>
                </div>
            </div>
            <div class="filter-section" id="workFilters" aria-label="–§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø–∞–º —Ä–∞–±–æ—Ç—ã">
                <h3 class="filter-toggle" aria-controls="workContainer" aria-expanded="true">
                    –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø–∞–º —Ä–∞–±–æ—Ç—ã (<span class="filter-count">0</span>)
                    <span class="toggle-icon"><i class="fas fa-chevron-down"></i></span>
                </h3>
                <div class="filter-content">
                    <div class="filter-container" id="workContainer"></div>
                </div>
            </div>
        </section>
        <div class="filters-controls">
            <button id="resetFilters" class="reset-btn" aria-label="–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
            <button id="toggleViewBtn" class="view-toggle-btn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∏–¥">
                <i class="fas fa-th"></i> –ö–∞—Ä—Ç–æ—á–∫–∏
            </button>
            <select id="themeSwitch" aria-label="–í—ã–±–æ—Ä —Ç–µ–º—ã">
                <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                <option value="dark">–¢–µ–º–Ω–∞—è</option>
            </select>
        </div>

        <div id="errorContainer" class="error-message" role="alert">
            <span class="error-text"></span>
            <button class="error-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">‚úï</button>
        </div>

        <section class="table-section">
            <table id="sitesTable" aria-label="–¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å–∞–π—Ç–æ–≤">
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞ <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                        <th onclick="sortTable(1)">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                        <th onclick="sortTable(2)">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                        <th onclick="sortTable(3)">–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                        <th onclick="sortTable(4)">–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                        <th onclick="sortTable(5)">–¢–∏–ø —Ä–∞–±–æ—Ç—ã <span class="sort-icon"><i class="fas fa-sort"></i></span></th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </section>
        <div id="pagination" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º"></div>
        <button id="themeToggleMobile" class="theme-toggle-mobile" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
    </div>

    <script>
        // JavaScript Functionality
        const DEFAULT_PROTOCOL = 'https://';
        const COLUMN_KEYS = [
            '–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞', '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', '–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞',
            '–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', '–ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã',
            '–¢–∏–ø —Ä–∞–±–æ—Ç—ã'
        ];
        const DIFFICULTY_ORDER = { –õ–µ–≥–∫–∞—è: 1, –°—Ä–µ–¥–Ω—è—è: 2, –°–ª–æ–∂–Ω–∞—è: 3 };
        const TABLE_CSV_URL = 'https://docs.google.com/spreadsheets/d/1-_Qzi00wtezoZSnNiAhgvXJFhBE4x7LhyihTHtZgXv4/export?format=csv&gid=1897875028';
        const FILTERS_CSV_URL = 'https://docs.google.com/spreadsheets/d/1-_Qzi00wtezoZSnNiAhgvXJFhBE4x7LhyihTHtZgXv4/export?format=csv&gid=1897875028';
        const SUPPORTED_LOCALES = ['ru-RU', 'en-US', 'fr-FR'];
        const RETRY_DELAYS = [1000, 2000, 4000];

        const appState = {
            tableData: [],
            originalTableData: [],
            sort: { column: -1, direction: 1 },
            filters: { payments: [], work: [] },
            locale: 'ru-RU',
            theme: 'light',
            view: 'table',
            user: null,
            page: 1,
            rowsPerPage: 10,
            logs: [],
            lastUpdated: null,
            latestUpdateFromH: null,
            filterStates: { paymentFilters: true, workFilters: true },
            fontSize: 1
        };

        function toggleView() {
            appState.view = appState.view === 'table' ? 'cards' : 'table';
            const tableSection = document.querySelector('.table-section');
            if (tableSection) {
                tableSection.style.opacity = '0';
                setTimeout(() => {
                    tableSection.classList.toggle('cards-view', appState.view === 'cards');
                    tableSection.style.opacity = '1';
                    localStorage.setItem('view', appState.view);
                    renderTable();
                    updateViewButton();
                }, 300);
            }
        }

        function updateViewButton() {
            const btn = document.getElementById('toggleViewBtn');
            if (btn) {
                const icon = btn.querySelector('i');
                if (appState.view === 'cards') {
                    icon.className = 'fas fa-table';
                    btn.innerHTML = '<i class="fas fa-table"></i> –¢–∞–±–ª–∏—Ü–∞';
                } else {
                    icon.className = 'fas fa-th';
                    btn.innerHTML = '<i class="fas fa-th"></i> –ö–∞—Ä—Ç–æ—á–∫–∏';
                }
            }
        }

        function escapeHTML(text) {
            const tempDiv = document.createElement('div');
            tempDiv.textContent = text ?? '';
            return tempDiv.innerHTML;
        }

        function normalizeText(text) {
            if (typeof text !== 'string' || !text.trim()) return '';
            const trimmed = text.trim();
            if (/^\d{4}$/.test(trimmed)) {
                const year = parseInt(trimmed, 10);
                if (year >= 1900 && year <= 2099) return trimmed;
            }
            const datePattern = /^(\d{2}\.\d{2}\.\d{4}|\d{4}-\d{2}-\d{2})$/;
            if (datePattern.test(trimmed)) {
                const date = new Date(trimmed.split('.').reverse().join('-') || trimmed);
                if (!isNaN(date.getTime())) return date.toLocaleString(appState.locale, { dateStyle: 'short' });
            }
            if (/^\d+(\.\d+)?$/.test(trimmed)) return new Intl.NumberFormat(appState.locale).format(parseFloat(trimmed));
            const urlPattern = /^(https?:\/\/[^\s]+|www\.[^\s]+|[^\s]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?)$/i;
            if (urlPattern.test(trimmed)) return trimmed;
            const normalized = trimmed.replace(/\s+/g, ' ');
            return normalized.length > 0 ? normalized.charAt(0).toUpperCase() + normalized.slice(1) : '';
        }

        function createLinkElement(text) {
            if (!text || !text.trim()) return document.createTextNode('');
            const urlPattern = /(https?:\/\/[^\s]+|www\.[^\s]+|[^\s]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?)/gi;
            const match = text.match(urlPattern);
            if (match) {
                let url = match[0];
                try {
                    url = url.match(/^[a-zA-Z]+:\/\//) ? url : `${DEFAULT_PROTOCOL}${url}`;
                    new URL(url);
                    const domainMatch = url.match(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i);
                    const domain = domainMatch ? domainMatch[1] : url;
                    const displayText = shortenSiteName(domain);
                    
                    const container = document.createElement('span');
                    container.className = 'site-link-with-icon';
                    
                    const img = document.createElement('img');
                    img.src = `https://www.google.com/s2/favicons?sz=32&domain=${domain}`;
                    img.alt = displayText;
                    img.className = 'site-icon';
                    img.onerror = function() { this.style.display = 'none'; };
                    container.appendChild(img);
                    
                    const link = document.createElement('a');
                    link.href = url;
                    link.target = '_blank';
                    link.rel = 'noopener noreferrer nofollow';
                    link.textContent = escapeHTML(displayText);
                    link.setAttribute('aria-label', `Visit ${displayText}`);
                    link.dataset.tooltip = url;
                    container.appendChild(link);
                    
                    return container;
                } catch {
                    return document.createTextNode(escapeHTML(text));
                }
            }
            return document.createTextNode(escapeHTML(text));
        }

        function shortenSiteName(site) {
            const match = site?.match(/^(?:.*\.)?([^.]+\.[a-zA-Z]{2,})(?:\/|$)/);
            const name = match ? match[1] : site || '';
            return name.charAt(0).toUpperCase() + name.slice(1);
        }

        async function fetchWithRetry(url, retries = 3) {
            for (let i = 0; i < retries; i++) {
                try {
                    const response = await fetch(url, { cache: 'force-cache' });
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    const text = await response.text();
                    if (navigator.serviceWorker) caches.open('table-cache').then(cache => cache.put(url, new Response(text)));
                    appState.lastUpdated = new Date();
                    updateLastUpdated();
                    return text;
                } catch (error) {
                    if (i === retries - 1) {
                        const cached = await caches.match(url);
                        if (cached) return cached.text();
                        logError(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: ${error.message}`);
                        throw error;
                    }
                    await new Promise(resolve => setTimeout(resolve, RETRY_DELAYS[i]));
                }
            }
        }

        function parseCSV(csv) {
            const rows = csv.trim().split('\n').map(row =>
                row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(cell => cell.trim().replace(/^"|"$/g, ''))
            );
            if (rows.length < 2) return [];
            const datesInH = rows.slice(1).map(row => {
                const dateStr = row[7] ? row[7].trim() : '';
                const date = new Date(dateStr.split('.').reverse().join('-') || dateStr);
                return isNaN(date.getTime()) ? null : date;
            }).filter(date => date !== null);
            appState.latestUpdateFromH = datesInH.length > 0 ? new Date(Math.max(...datesInH)) : null;
            return rows.slice(1).map(row => ({
                [COLUMN_KEYS[0]]: row[0] || '',
                [COLUMN_KEYS[1]]: normalizeText(row[1] || ''),
                [COLUMN_KEYS[2]]: normalizeText(row[2] || ''),
                [COLUMN_KEYS[3]]: normalizeText(row[3] || ''),
                [COLUMN_KEYS[4]]: row[4] ? row[4].split(/,\s*/).map(normalizeText).join(', ') : '',
                [COLUMN_KEYS[5]]: row[5] ? row[5].split(/,\s*/).map(normalizeText).join(', ') : ''
            })).filter(row => row[COLUMN_KEYS[0]]);
        }

        function parseFilterCSV(csv) {
            const rows = csv.trim().split('\n').map(row =>
                row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(cell => cell.trim().replace(/^"|"$/g, ''))
            );
            if (rows.length < 2) return { payments: [], work: [] };
            const payments = new Set();
            const work = new Set();
            rows.slice(1).forEach(row => {
                (row[4] || '').split(/,\s*/).forEach(p => { if (p) payments.add(normalizeText(p)); });
                (row[5] || '').split(/,\s*/).forEach(w => { if (w) work.add(normalizeText(w)); });
            });
            return {
                payments: [...payments].sort(),
                work: [...work].sort()
            };
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            if (!tbody) {
                logError('–≠–ª–µ–º–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            tbody.innerHTML = '';
            const start = (appState.page - 1) * appState.rowsPerPage;
            const end = start + appState.rowsPerPage;
            const paginatedData = appState.tableData.slice(start, end);

            if (appState.view === 'cards') {
                const columns = [[], []];
                paginatedData.forEach((row, index) => {
                    columns[index % 2].push(row);
                });

                columns.forEach((columnData) => {
                    const colDiv = document.createElement('div');
                    colDiv.className = 'card-column';
                    columnData.forEach(row => {
                        const tr = document.createElement('tr');
                        for (let i = 0; i < COLUMN_KEYS.length; i++) {
                            tr.appendChild(createTableCell(row[COLUMN_KEYS[i]], COLUMN_KEYS[i], i === 0 ? createLinkElement : undefined));
                        }
                        colDiv.appendChild(tr);
                    });
                    tbody.appendChild(colDiv);
                });
            } else {
                paginatedData.forEach(row => {
                    const tr = document.createElement('tr');
                    for (let i = 0; i < COLUMN_KEYS.length; i++) {
                        tr.appendChild(createTableCell(row[COLUMN_KEYS[i]], COLUMN_KEYS[i], i === 0 ? createLinkElement : undefined));
                    }
                    tbody.appendChild(tr);
                });
            }
            animateRows(tbody);
            updatePaginationControls();
        }

        function createTableCell(value, label, creator = (val => document.createTextNode(escapeHTML(val || '–ù–µ —É–∫–∞–∑–∞–Ω–æ')))) {
            const td = document.createElement('td');
            td.setAttribute('data-label', label);
            td.appendChild(creator(value));
            if (value && /\d+(\.\d+)?/.test(value)) td.classList.add('numeric');
            return td;
        }

        function renderFilters(filterData) {
            const containers = {
                payment: document.getElementById('paymentContainer'),
                work: document.getElementById('workContainer')
            };
            Object.entries(containers).forEach(([type, container]) => {
                if (!container) {
                    logError(`–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è ${type} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                    return;
                }
                container.innerHTML = '';
                const items = filterData[type === 'payment' ? 'payments' : 'work'];
                if (items) {
                    items.forEach((item, index) => {
                        const id = `${type}-${index}`;
                        const label = document.createElement('label');
                        label.setAttribute('for', id);
                        label.innerHTML = `<input type="checkbox" id="${id}" name="${type}" value="${item}" aria-label="${item}"><span>${escapeHTML(item)}</span>`;
                        container.appendChild(label);
                    });
                }
            });
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.addEventListener('change', applyFilters));
            updateFilterCounts();
        }

        function sortTable(columnIndex) {
            if (appState.sort.column === columnIndex) appState.sort.direction *= -1;
            else appState.sort.direction = 1;
            appState.sort.column = columnIndex;
            appState.tableData.sort((a, b) => {
                let aValue = a[COLUMN_KEYS[columnIndex]] || '';
                let bValue = b[COLUMN_KEYS[columnIndex]] || '';
                if (columnIndex === 7) {
                    aValue = aValue.split('\n')[0];
                    bValue = bValue.split('\n')[0];
                }
                if ([0, 3, 7].includes(columnIndex)) return appState.sort.direction * aValue.localeCompare(bValue);
                if (columnIndex === 1) {
                    const aTime = Date.parse(aValue) || 0;
                    const bTime = Date.parse(bValue) || 0;
                    return appState.sort.direction * (aTime - bTime);
                }
                if (columnIndex === 2) return appState.sort.direction * (parseFloat(aValue) || 0 - parseFloat(bValue) || 0);
                if (columnIndex === 4) return appState.sort.direction * ((DIFFICULTY_ORDER[aValue] || 0) - (DIFFICULTY_ORDER[bValue] || 0));
                return appState.sort.direction * (aValue.split('\n').length - bValue.split('\n').length);
            });
            updateArrow(columnIndex);
            renderTable();
        }

        function animateRows(container) {
            container.querySelectorAll('tr').forEach((row, idx) => {
                row.style.opacity = '0';
                row.style.transform = 'translateY(1rem)';
                setTimeout(() => {
                    row.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                    row.style.opacity = '1';
                    row.style.transform = 'translateY(0)';
                }, idx * 50);
            });
        }

        function updateArrow(columnIndex) {
            document.querySelectorAll('thead th .sort-icon').forEach((arrow, idx) => {
                arrow.classList.toggle('active', idx === columnIndex);
                arrow.innerHTML = idx === columnIndex
                    ? (appState.sort.direction === 1 ? '<i class="fas fa-sort-up"></i>' : '<i class="fas fa-sort-down"></i>')
                    : '<i class="fas fa-sort"></i>';
            });
        }

        function updatePaginationControls() {
            const pagination = document.getElementById('pagination');
            if (!pagination) {
                logError('–≠–ª–µ–º–µ–Ω—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            const totalPages = Math.ceil(appState.tableData.length / appState.rowsPerPage);
            if (appState.tableData.length <= appState.rowsPerPage) {
                pagination.style.display = 'none';
                return;
            }
            pagination.style.display = 'flex';
            pagination.innerHTML = `
                ${appState.page > 3 ? '<button aria-label="–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É" onclick="changePageTo(1)">–í –Ω–∞—á–∞–ª–æ</button>' : ''}
                <button aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞" ${appState.page === 1 ? 'disabled' : ''} onclick="changePage(-1)">–ù–∞–∑–∞–¥</button>
                <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${appState.page} –∏–∑ ${totalPages}</span>
                <button aria-label="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞" ${appState.page === totalPages ? 'disabled' : ''} onclick="changePage(1)">–í–ø–µ—Ä–µ–¥</button>
                <select onchange="changeRowsPerPage(this.value)" aria-label="–°—Ç—Ä–æ–∫ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ">
                    ${[10, 25, 50, 100].map(n => `<option value="${n}" ${n === appState.rowsPerPage ? 'selected' : ''}>${n}</option>`).join('')}
                </select>
            `;
            addSwipeListeners();
        }

        function updateLastUpdated() {
            const timestampElement = document.getElementById('updateTimestamp');
            if (timestampElement && appState.lastUpdated) {
                timestampElement.textContent = appState.lastUpdated.toLocaleString(appState.locale, { dateStyle: 'medium', timeStyle: 'short' });
            }
        }

        function updateFilterCounts() {
            document.querySelectorAll('.filter-toggle .filter-count').forEach(count => {
                const type = count.closest('.filter-section').id === 'paymentFilters' ? 'payments' : 'work';
                count.textContent = appState.filters[type].length;
            });
        }

        function applyFilters() {
            const selectedPayments = Array.from(document.querySelectorAll('input[name="payment"]:checked')).map(cb => cb.value);
            const selectedWork = Array.from(document.querySelectorAll('input[name="work"]:checked')).map(cb => cb.value);
            appState.filters.payments = selectedPayments;
            appState.filters.work = selectedWork;
            let filteredData = [...appState.originalTableData];
            if (selectedPayments.length > 0) {
                filteredData = filteredData.filter(row => {
                    const payments = (row[COLUMN_KEYS[4]] || '').split(/,\s*/).map(item => item.trim()).filter(Boolean);
                    return selectedPayments.some(p => payments.includes(p));
                });
            }
            if (selectedWork.length > 0) {
                filteredData = filteredData.filter(row => {
                    const work = (row[COLUMN_KEYS[5]] || '').split(/,\s*/).map(item => item.trim()).filter(Boolean);
                    return selectedWork.some(w => work.includes(w));
                });
            }
            appState.tableData = filteredData;
            appState.page = 1;
            renderTable();
            updateFilterCounts();
        }

        function changePage(delta) {
            appState.page = Math.max(1, Math.min(appState.page + delta, Math.ceil(appState.tableData.length / appState.rowsPerPage)));
            renderTable();
        }

        function changePageTo(page) {
            appState.page = page;
            renderTable();
        }

        function changeRowsPerPage(value) {
            appState.rowsPerPage = parseInt(value, 10);
            appState.page = 1;
            renderTable();
        }

        function showError(message, isCritical = false) {
            const errorContainer = document.getElementById('errorContainer');
            const errorText = errorContainer.querySelector('.error-text');
            if (errorContainer && errorText) {
                errorText.textContent = message;
                errorContainer.classList.remove('hide');
                errorContainer.classList.add('show', isCritical ? 'critical' : 'warning');
                setTimeout(() => hideError(), window.innerWidth <= 480 ? 7000 : 5000);
            }
        }

        function hideError() {
            const errorContainer = document.getElementById('errorContainer');
            if (errorContainer) {
                errorContainer.classList.add('hide');
                errorContainer.addEventListener('animationend', () => {
                    errorContainer.classList.remove('show', 'critical', 'warning');
                }, { once: true });
            }
        }

        function logError(message) {
            appState.logs.push({ timestamp: new Date().toISOString(), message });
            showError(message);
        }

        function setTheme(theme) {
            appState.theme = theme;
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            document.getElementById('themeToggleMobile').textContent = theme === 'light' ? 'üåô' : '‚òÄ';
        }

        function getParamContext(param) {
            const paramLower = (param || '').toLowerCase();
            if (paramLower.includes('—Å–ª–æ–∂–Ω–æ—Å—Ç—å')) {
                return { text: `—Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏`, gender: 'female' };
            } else if (paramLower.includes('–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è') || paramLower.includes('–≤—ã–≤–æ–¥')) {
                return { text: `–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞`, gender: 'female' };
            } else if (paramLower.includes('—Ä–µ—Ñ–µ—Ä–∞–ª')) {
                return { text: `—Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞`, gender: 'female' };
            } else if (paramLower.includes('–≥–æ–¥')) {
                return { text: `–≥–æ–¥ —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–π—Ç–∞`, gender: 'male' };
            } else if (paramLower.includes('–ø–ª–∞—Ç—ë–∂') || paramLower.includes('–ø–ª–∞—Ç–µ–∂')) {
                return { text: `—Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º`, gender: 'male' };
            } else if (param) {
                return { text: param.toLowerCase(), gender: 'neuter' };
            } else {
                return { text: `–ø–∞—Ä–∞–º–µ—Ç—Ä`, gender: 'male' };
            }
        }

        function shortenSiteName(site) {
            if (!site) return '';
            let result;
            // If site already has a domain extension, use as is
            if (/\.[a-zA-Z]{2,}$/.test(site)) {
                result = site;
            } else {
                // If not, add .com
                result = site + '.com';
            }
            // Capitalize first letter
            return result.charAt(0).toUpperCase() + result.slice(1);
        }

        function createChangeLinkElement(text) {
            if (!text || text.trim() === '') return document.createTextNode('');
            const urlPattern = /(https?:\/\/[^\s]+|www\.[^\s]+|[^\s]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?)/gi;
            const match = text.match(urlPattern);
            if (match) {
                let url = match[0];
                if (!url.match(/^https?:\/\//)) url = 'https://' + url;
                const domainMatch = url.match(/^(?:https?:\/\/)?(?:www\.)?([^\/]+)/i);
                let displayText = domainMatch ? domainMatch[1] : url;
                displayText = displayText.charAt(0).toUpperCase() + displayText.slice(1);
                const a = document.createElement('a');
                a.href = url;
                a.target = '_blank';
                a.rel = 'noopener noreferrer nofollow';
                a.textContent = escapeHTML(displayText);
                return a;
            }
            return document.createTextNode(escapeHTML(text));
        }

        function formatChangeDateTime(dateStr) {
            if (!dateStr) return '';
            const parts = dateStr.split(' ');
            if (parts.length !== 2) return dateStr;
            const date = parts[0];
            const time = parts[1];
            const timeParts = time.split(':');
            if (timeParts.length === 3) {
                const hours = timeParts[0].padStart(2, '0');
                const minutes = timeParts[1].padStart(2, '0');
                const seconds = timeParts[2].padStart(2, '0');
                return `${date}, ${hours}:${minutes}:${seconds}`;
            }
            return dateStr;
        }

        function createChangeElement(change) {
            const timestamp = change['–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è'] || '–¥–∞—Ç–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞';
            const param = change['–ü–∞—Ä–∞–º–µ—Ç—Ä'] || '';
            const oldValueText = change['–ë—ã–ª–æ'] || '';
            const newValueText = change['–°—Ç–∞–ª–æ'] || '';
            const site = change['–°–∞–π—Ç'] || '';
            const displaySite = shortenSiteName(site);
            const contextObj = getParamContext(param);
            const context = contextObj.text;
            const gender = contextObj.gender;

            const li = document.createElement('li');
            li.dataset.site = site;
            li.dataset.timestamp = timestamp;

            const sentenceStart = document.createTextNode(`–ù–∞ —Å–∞–π—Ç–µ `);
            li.appendChild(sentenceStart);

            const siteSpan = document.createElement('span');
            siteSpan.className = 'site-name';
            siteSpan.appendChild(createChangeLinkElement(site));
            li.appendChild(siteSpan);

            if (!oldValueText && !newValueText) {
                const formattedTime = formatChangeDateTime(timestamp);
                li.appendChild(document.createTextNode(` –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ ${formattedTime}.`));
                return li;
            }

            let updatedVerb = '';
            if (gender === 'male') {
                updatedVerb = ' –æ–±–Ω–æ–≤–ª—ë–Ω';
            } else if (gender === 'female') {
                updatedVerb = ' –æ–±–Ω–æ–≤–ª–µ–Ω–∞';
            } else {
                updatedVerb = ' –æ–±–Ω–æ–≤–ª–µ–Ω–æ';
            }

            const sentenceMiddle = document.createTextNode(` ${context}${updatedVerb} `);
            li.appendChild(sentenceMiddle);

            if (oldValueText) {
                li.appendChild(document.createTextNode('—Å '));
                const oldValueSpan = document.createElement('span');
                oldValueSpan.className = 'old-value';
                oldValueSpan.appendChild(createChangeLinkElement(oldValueText));
                li.appendChild(oldValueSpan);
            }

            if (oldValueText || newValueText) {
                const arrowSpan = document.createElement('span');
                arrowSpan.textContent = ' –Ω–∞ ';
                li.appendChild(arrowSpan);
            }

            if (newValueText) {
                const newValueSpan = document.createElement('span');
                newValueSpan.className = 'new-value';
                newValueSpan.appendChild(createChangeLinkElement(newValueText));
                li.appendChild(newValueSpan);
            }

            const formattedTime = formatChangeDateTime(timestamp);
            li.appendChild(document.createTextNode(` –≤ ${formattedTime}.`));
            return li;
        }

        function updateLastChanges() {
            const changesList = document.getElementById('changesList');
            if (!changesList || !appState.lastChanges) return;
            changesList.innerHTML = '';
            const recentChanges = Array.isArray(appState.lastChanges) 
                ? appState.lastChanges.slice(0, 5) 
                : [];
            recentChanges.forEach(change => {
                changesList.appendChild(createChangeElement(change));
            });
        }

        function toggleLastChanges() {
            const content = document.getElementById('lastChangesContent');
            if (content) {
                content.classList.toggle('hidden');
                const toggleBtn = document.getElementById('toggleLastChanges');
                const icon = toggleBtn?.querySelector('i');
                if (icon) {
                    icon.className = content.classList.contains('hidden') ? 'fas fa-eye-slash' : 'fas fa-eye';
                }
            }
        }

        function escapeHTML(text) {
            const tempDiv = document.createElement('div');
            tempDiv.textContent = text ?? '';
            return tempDiv.innerHTML;
        }

        function adjustFontSize(delta) {
            appState.fontSize = Math.max(0.8, Math.min(1.5, appState.fontSize + delta));
            document.documentElement.style.fontSize = `${appState.fontSize}rem`;
            localStorage.setItem('fontSize', appState.fontSize);
        }

        function addSwipeListeners() {
            const tableSection = document.querySelector('.table-section');
            let touchStartX = 0;
            let touchEndX = 0;
            tableSection.addEventListener('touchstart', e => touchStartX = e.changedTouches[0].screenX);
            tableSection.addEventListener('touchend', e => {
                touchEndX = e.changedTouches[0].screenX;
                if (touchStartX - touchEndX > 50) changePage(1);
                if (touchEndX - touchStartX > 50) changePage(-1);
            });
        }

        async function loadLastChanges() {
            try {
                const response = await fetch('/api/changes');
                if (!response.ok) throw new Error('Failed to load changes');
                const data = await response.json();
                appState.lastChanges = data.slice(-5).reverse().map(item => ({
                    '–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è': item.datetime,
                    '–°–∞–π—Ç': item.site,
                    '–ü–∞—Ä–∞–º–µ—Ç—Ä': item.param,
                    '–ë—ã–ª–æ': item.old,
                    '–°—Ç–∞–ª–æ': item.new
                }));
            } catch (error) {
                console.warn('Could not load last changes:', error);
                appState.lastChanges = [];
            }
            updateLastChanges();
        }

        async function init() {
            try {
                const [tableCsv, filterCsv] = await Promise.all([
                    fetchWithRetry(TABLE_CSV_URL),
                    fetchWithRetry(FILTERS_CSV_URL)
                ]);
                appState.originalTableData = parseCSV(tableCsv);
                appState.tableData = [...appState.originalTableData];
                const filterData = parseFilterCSV(filterCsv);
                renderTable();
                renderFilters(filterData);
                loadLastChanges();
                setTheme(localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
                appState.fontSize = parseFloat(localStorage.getItem('fontSize')) || 1;
                document.documentElement.style.fontSize = `${appState.fontSize}rem`;

                setInterval(() => fetchWithRetry(TABLE_CSV_URL).then(csv => {
                    appState.originalTableData = parseCSV(csv);
                    appState.tableData = [...appState.originalTableData];
                    applyFilters();
                }), 30000);

                document.getElementById('resetFilters').addEventListener('click', () => {
                    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                    appState.filters.payments = [];
                    appState.filters.work = [];
                    appState.tableData = [...appState.originalTableData];
                    appState.page = 1;
                    renderTable();
                });

                document.getElementById('toggleLastChanges')?.addEventListener('click', toggleLastChanges);
                document.getElementById('themeSwitch').addEventListener('change', e => setTheme(e.target.value));
                document.getElementById('fontSizeIncrease').addEventListener('click', () => adjustFontSize(0.1));
                document.getElementById('fontSizeDecrease').addEventListener('click', () => adjustFontSize(-0.1));
                document.getElementById('themeToggleMobile').addEventListener('click', () => setTheme(appState.theme === 'light' ? 'dark' : 'light'));
                document.getElementById('toggleViewBtn')?.addEventListener('click', toggleView);

                const savedView = localStorage.getItem('view') || 'table';
                if (savedView !== appState.view) {
                    appState.view = savedView;
                    const tableSection = document.querySelector('.table-section');
                    if (tableSection) {
                        tableSection.classList.toggle('cards-view', appState.view === 'cards');
                    }
                    updateViewButton();
                }
                document.querySelectorAll('.filter-toggle').forEach(toggle => {
                    toggle.addEventListener('click', () => {
                        const filterSection = toggle.closest('.filter-section');
                        const sectionId = filterSection.id;
                        filterSection.classList.toggle('collapsed');
                        appState.filterStates[sectionId] = !filterSection.classList.contains('collapsed');
                        toggle.setAttribute('aria-expanded', appState.filterStates[sectionId]);
                    });
                });
                document.querySelector('.error-close').addEventListener('click', hideError);

                window.addEventListener('resize', () => {
                    appState.rowsPerPage = Math.max(10, Math.min(100, Math.floor(window.innerHeight / 50)));
                    renderTable();
                });
            } catch (error) {
                logError(`–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`);
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>